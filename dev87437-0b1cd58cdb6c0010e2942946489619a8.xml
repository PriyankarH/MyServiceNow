<?xml version="1.0" encoding="UTF-8"?><unload unload_date="2019-10-20 08:01:12"><sys_remote_update_set action="INSERT_OR_UPDATE"><application display_value="Global">global</application><application_name>Global</application_name><application_scope>global</application_scope><application_version/><collisions/><commit_date/><deleted/><description/><inserted/><name>Snow GitLab Integration - Priyankar</name><origin_sys_id/><parent/><release_date/><remote_base_update_set/><remote_parent_id/><remote_sys_id>0b1cd58cdb6c0010e2942946489619a8</remote_sys_id><state>loaded</state><summary/><sys_class_name>sys_remote_update_set</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2019-10-20 08:01:12</sys_created_on><sys_id>dde39522db200010e2942946489619ca</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2019-10-20 08:01:12</sys_updated_on><update_set/><update_source/><updated/></sys_remote_update_set><sys_update_xml action="INSERT_OR_UPDATE"><action>INSERT_OR_UPDATE</action><application display_value="Global">global</application><category>customer</category><comments/><name>sys_properties_b2b8d520dba80010e29429464896197f</name><payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>false</ignore_cache><is_private>false</is_private><name>com.gitlabce.base.url</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2019-10-14 03:15:29</sys_created_on><sys_id>b2b8d520dba80010e29429464896197f</sys_id><sys_mod_count>0</sys_mod_count><sys_name>com.gitlabce.base.url</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_b2b8d520dba80010e29429464896197f</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2019-10-14 03:15:29</sys_updated_on><type>string</type><value>https://gitlabce.tools.ci.vodafone.com</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=b2b8d520dba80010e29429464896197f"/></record_update>]]></payload><payload_hash>-407680358</payload_hash><remote_update_set display_value="Snow GitLab Integration - Priyankar">dde39522db200010e2942946489619ca</remote_update_set><replace_on_upgrade>false</replace_on_upgrade><sys_created_by>admin</sys_created_by><sys_created_on>2019-10-20 08:01:12</sys_created_on><sys_id>11e39522db200010e2942946489619cd</sys_id><sys_mod_count>0</sys_mod_count><sys_recorded_at>16dc84385d00000001</sys_recorded_at><sys_updated_by>admin</sys_updated_by><sys_updated_on>2019-10-20 08:01:12</sys_updated_on><table/><target_name>com.gitlabce.base.url</target_name><type>System Property</type><update_domain>global</update_domain><update_guid>bdf859203aa80010d9e6968e9b084dc8</update_guid><update_guid_history>bdf859203aa80010d9e6968e9b084dc8:-407680358</update_guid_history><update_set/><view/></sys_update_xml><sys_update_xml action="INSERT_OR_UPDATE"><action>INSERT_OR_UPDATE</action><application display_value="Global">global</application><category>customer</category><comments/><name>sys_properties_3ca9d920dba80010e2942946489619b8</name><payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>false</ignore_cache><is_private>false</is_private><name>com.gitlabce.project</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2019-10-14 03:18:27</sys_created_on><sys_id>3ca9d920dba80010e2942946489619b8</sys_id><sys_mod_count>0</sys_mod_count><sys_name>com.gitlabce.project</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_3ca9d920dba80010e2942946489619b8</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2019-10-14 03:18:27</sys_updated_on><type>string</type><value>103</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=3ca9d920dba80010e2942946489619b8"/></record_update>]]></payload><payload_hash>-614424488</payload_hash><remote_update_set display_value="Snow GitLab Integration - Priyankar">dde39522db200010e2942946489619ca</remote_update_set><replace_on_upgrade>false</replace_on_upgrade><sys_created_by>admin</sys_created_by><sys_created_on>2019-10-20 08:01:12</sys_created_on><sys_id>51e39522db200010e2942946489619cc</sys_id><sys_mod_count>0</sys_mod_count><sys_recorded_at>16dc8463a120000001</sys_recorded_at><sys_updated_by>admin</sys_updated_by><sys_updated_on>2019-10-20 08:01:12</sys_updated_on><table/><target_name>com.gitlabce.project</target_name><type>System Property</type><update_domain>global</update_domain><update_guid>81a9d56037a800106e0527cd3fd3f247</update_guid><update_guid_history>81a9d56037a800106e0527cd3fd3f247:-614424488</update_guid_history><update_set/><view/></sys_update_xml><sys_update_xml action="INSERT_OR_UPDATE"><action>INSERT_OR_UPDATE</action><application display_value="Global">global</application><category>customer</category><comments/><name>sys_properties_aed95560dba80010e29429464896195a</name><payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>false</ignore_cache><is_private>false</is_private><name>com.gitlabce.access.token</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2019-10-14 03:19:24</sys_created_on><sys_id>aed95560dba80010e29429464896195a</sys_id><sys_mod_count>0</sys_mod_count><sys_name>com.gitlabce.access.token</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_aed95560dba80010e29429464896195a</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2019-10-14 03:19:24</sys_updated_on><type>string</type><value>dMxHsUFMHVgW33xPxX7K</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=aed95560dba80010e29429464896195a"/></record_update>]]></payload><payload_hash>381692170</payload_hash><remote_update_set display_value="Snow GitLab Integration - Priyankar">dde39522db200010e2942946489619ca</remote_update_set><replace_on_upgrade>false</replace_on_upgrade><sys_created_by>admin</sys_created_by><sys_created_on>2019-10-20 08:01:12</sys_created_on><sys_id>5de39522db200010e2942946489619cc</sys_id><sys_mod_count>0</sys_mod_count><sys_recorded_at>16dc84718690000001</sys_recorded_at><sys_updated_by>admin</sys_updated_by><sys_updated_on>2019-10-20 08:01:12</sys_updated_on><table/><target_name>com.gitlabce.access.token</target_name><type>System Property</type><update_domain>global</update_domain><update_guid>07d9d9601ba800109a5d4ef6e6f17b78</update_guid><update_guid_history>07d9d9601ba800109a5d4ef6e6f17b78:381692170</update_guid_history><update_set/><view/></sys_update_xml><sys_update_xml action="INSERT_OR_UPDATE"><action>INSERT_OR_UPDATE</action><application display_value="Global">global</application><category>customer</category><comments/><name>sys_properties_94295d20dba80010e294294648961934</name><payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>false</ignore_cache><is_private>false</is_private><name>com.gitlabce.file.path</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2019-10-14 03:16:14</sys_created_on><sys_id>94295d20dba80010e294294648961934</sys_id><sys_mod_count>2</sys_mod_count><sys_name>com.gitlabce.file.path</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_94295d20dba80010e294294648961934</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2019-10-14 03:18:07</sys_updated_on><type>string</type><value>Source Instance/</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=94295d20dba80010e294294648961934"/></record_update>]]></payload><payload_hash>665424387</payload_hash><remote_update_set display_value="Snow GitLab Integration - Priyankar">dde39522db200010e2942946489619ca</remote_update_set><replace_on_upgrade>false</replace_on_upgrade><sys_created_by>admin</sys_created_by><sys_created_on>2019-10-20 08:01:12</sys_created_on><sys_id>99e39522db200010e2942946489619cc</sys_id><sys_mod_count>0</sys_mod_count><sys_recorded_at>16dc845ed7c0000001</sys_recorded_at><sys_updated_by>admin</sys_updated_by><sys_updated_on>2019-10-20 08:01:12</sys_updated_on><table/><target_name>com.gitlabce.file.path</target_name><type>System Property</type><update_domain>global</update_domain><update_guid>1c9915605ba800109f6be275d09e12dd</update_guid><update_guid_history>1c9915605ba800109f6be275d09e12dd:665424387,ec4999208ba800104a8ff087a4db9b99:-614424488,70295d205fa8001045531c7262254c3f:-822118314</update_guid_history><update_set/><view/></sys_update_xml><sys_update_xml action="INSERT_OR_UPDATE"><action>INSERT_OR_UPDATE</action><application display_value="Global">global</application><category>customer</category><comments/><name>sys_ui_action_b36719ecdb680010e294294648961993</name><payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sys_ui_action"&gt;&lt;sys_ui_action action="INSERT_OR_UPDATE"&gt;&lt;action_name&gt;commit_gitlabce&lt;/action_name&gt;&lt;active&gt;true&lt;/active&gt;&lt;client&gt;false&lt;/client&gt;&lt;client_script_v2&gt;&lt;![CDATA[function onClick(g_form) {

}]]&gt;&lt;/client_script_v2&gt;&lt;comments/&gt;&lt;condition&gt;current.state=='complete'&lt;/condition&gt;&lt;form_action&gt;true&lt;/form_action&gt;&lt;form_button&gt;false&lt;/form_button&gt;&lt;form_button_v2&gt;false&lt;/form_button_v2&gt;&lt;form_context_menu&gt;false&lt;/form_context_menu&gt;&lt;form_link&gt;true&lt;/form_link&gt;&lt;form_menu_button_v2&gt;false&lt;/form_menu_button_v2&gt;&lt;form_style/&gt;&lt;hint/&gt;&lt;isolate_script&gt;false&lt;/isolate_script&gt;&lt;list_action&gt;false&lt;/list_action&gt;&lt;list_banner_button&gt;false&lt;/list_banner_button&gt;&lt;list_button&gt;false&lt;/list_button&gt;&lt;list_choice&gt;false&lt;/list_choice&gt;&lt;list_context_menu&gt;false&lt;/list_context_menu&gt;&lt;list_link&gt;false&lt;/list_link&gt;&lt;list_save_with_form_button&gt;false&lt;/list_save_with_form_button&gt;&lt;list_style/&gt;&lt;name&gt;Commit to GitLab&lt;/name&gt;&lt;onclick/&gt;&lt;order&gt;100&lt;/order&gt;&lt;script&gt;&lt;![CDATA[var content = '{"source":"https://'+gs.getProperty('instance_name')+'.service-now.com"';
var lusGR = new GlideRecord('sys_update_set'); //local update set
lusGR.get(current.sys_id);
var rusObj = {};
rusObj.remote_sys_id = lusGR.sys_id.toString();
rusObj.state = 'loaded';
rusObj.description = lusGR.description.toString();
rusObj.name = lusGR.name.toString();
rusObj.release_date = lusGR.release_date.toString();
rusObj.application = lusGR.application.toString();
var scopeGr = new GlideRecord('sys_scope');
scopeGr.get(lusGR.application);
if (scopeGr.isValid()) {
	rusObj.application_name = scopeGr.name.toString();
	rusObj.application_scope = scopeGr.scope.toString();
	rusObj.application_version = scopeGr.version.toString();
}
content += ',"sys_remote_update_set":'+JSON.stringify(rusObj);
var cuArr = [];
var cuGR = new GlideRecord('sys_update_xml');
cuGR.addQuery('update_set',lusGR.sys_id);
cuGR.query();
while(cuGR.next()) {
	var cuObj = {};
	for(var col in cuGR) {
		if(!{}.hasOwnProperty.call(cuObj, col) &amp;&amp; col!='sys_meta') {
			cuObj[col] = cuGR[col].toString();
		}
	}
	cuObj.update_set = '';
	cuArr.push(JSON.stringify(cuObj));
}
content += ', "sys_update_xml":['+cuArr.toString()+']}';
var restMessage = new sn_ws.RESTMessageV2();
restMessage.setRequestHeader('Content-Type','application/json');
restMessage.setRequestHeader('Private-Token',gs.getProperty('com.gitlabce.access.token'));
restMessage.setHttpMethod("post");
restMessage.setEndpoint(gs.getProperty('com.gitlabce.base.url')+'/api/v4/projects/'+encodeURIComponent(gs.getProperty('com.gitlabce.project'))+'/repository/files/'+encodeURIComponent(gs.getProperty('com.gitlabce.file.path'))+lusGR.name+'.json');
//var util = new GlideStringUtil();
//var encodedContents = util.base64Encode(content);
var reqBody = {};
reqBody.branch = 'master';
reqBody.author_email = 'devops.admin@vodafone.com';
reqBody.author_name = 'DevOps Admin';
reqBody.content = content;
reqBody.commit_message = 'Update set in json format from SNow: '+gs.getProperty('instance_name');
gs.log(JSON.stringify(reqBody),'gitlabce.request.'+lusGR.sys_id);
restMessage.setRequestBody(JSON.stringify(reqBody));
var response = restMessage.execute();
var body = response.getBody();
var parser = new JSON();
var bodyObj = parser.decode(body);
gs.addInfoMessage(JSON.stringify(bodyObj)/*,'gitlabce.response'*/);
action.setRedirectURL(current);]]&gt;&lt;/script&gt;&lt;show_insert&gt;false&lt;/show_insert&gt;&lt;show_multiple_update&gt;false&lt;/show_multiple_update&gt;&lt;show_query&gt;false&lt;/show_query&gt;&lt;show_update&gt;true&lt;/show_update&gt;&lt;sys_class_name&gt;sys_ui_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2019-10-14 03:30:44&lt;/sys_created_on&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;b36719ecdb680010e294294648961993&lt;/sys_id&gt;&lt;sys_mod_count&gt;9&lt;/sys_mod_count&gt;&lt;sys_name&gt;Commit to GitLab&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_action_b36719ecdb680010e294294648961993&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;subhadip.bagchi@vodafone.com&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2019-10-17 13:19:39&lt;/sys_updated_on&gt;&lt;table&gt;sys_update_set&lt;/table&gt;&lt;ui11_compatible&gt;true&lt;/ui11_compatible&gt;&lt;ui16_compatible&gt;false&lt;/ui16_compatible&gt;&lt;/sys_ui_action&gt;&lt;/record_update&gt;</payload><payload_hash>-666005150</payload_hash><remote_update_set display_value="Snow GitLab Integration - Priyankar">dde39522db200010e2942946489619ca</remote_update_set><replace_on_upgrade>false</replace_on_upgrade><sys_created_by>admin</sys_created_by><sys_created_on>2019-10-20 08:01:12</sys_created_on><sys_id>d1e39522db200010e2942946489619cd</sys_id><sys_mod_count>0</sys_mod_count><sys_recorded_at>16dd9dfb3690000001</sys_recorded_at><sys_updated_by>admin</sys_updated_by><sys_updated_on>2019-10-20 08:01:12</sys_updated_on><table>sys_update_set</table><target_name>Commit to GitLab</target_name><type>UI Action</type><update_domain>global</update_domain><update_guid>340043a924200010e9bfb09be6aa649d</update_guid><update_guid_history>340043a924200010e9bfb09be6aa649d:-666005150,9cff72a9f82000104e0e5efe3132e997:439218827,901f78019ba400109b6356e0f3998b38:-666005150,6733a5a4c5a80010cfeb51a91009816f:1110259808,c4c0696026a80010175b4b0534e13970:-1690086710,78a02d641fa80010296ceea270836f60:628551296,2aefd5644fa80010fe54442d5e55dd3d:-1662577374,d47f5d60a8a800107323b52396ca8a15:-1869109440,943dd52028a80010d51abe05e2ef4acc:-380282594,387cd52030a800101e47ffd19b24a7bf:2071948360</update_guid_history><update_set/><view/></sys_update_xml></unload>